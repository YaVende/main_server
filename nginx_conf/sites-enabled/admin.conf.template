upstream admin_upstream {
  server unix://${ADMIN_SOCK_PATH} fail_timeout=0;
}

server {
  server_name ${ADMIN_DOMAIN};
  include '/etc/nginx/snippets/acme_challenge.conf';
}

server {
  include '/etc/nginx/snippets/rails_app.conf';
  include '/etc/nginx/snippets/https.conf';

  server_name ${ADMIN_DOMAIN};
  listen 443 ssl http2;
  listen [::]:443 ssl http2;

  root ${ADMIN_ASSETS_PATH};

  location @app {
    include '/etc/nginx/snippets/proxy.conf';
    proxy_pass http://admin_upstream;
  }
}
